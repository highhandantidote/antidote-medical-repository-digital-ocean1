<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Antidote - {% block title %}Plastic Surgery Marketplace{% endblock %}</title>
    <!-- Enhanced SEO Meta Tags -->
    <meta name="description" content="{% block meta_description %}Antidote - India's premier medical marketplace connecting patients with qualified specialists for plastic surgery and cosmetic procedures. Compare costs, read reviews, book consultations.{% endblock %}">
    <meta name="keywords" content="{% block meta_keywords %}medical marketplace, plastic surgery, cosmetic procedures, India, doctors, healthcare, clinic booking, aesthetic surgery, consultation booking{% endblock %}">
    <meta name="author" content="Antidote Healthcare">
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="csrf-token" content="{{ csrf_token() }}">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="{% block canonical_url %}https://antidote.replit.app{{ request.path }}{% endblock %}">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="{% block og_title %}{{ self.title() }} - Antidote{% endblock %}">
    <meta property="og:description" content="{% block og_description %}{{ self.meta_description() }}{% endblock %}">
    <meta property="og:type" content="{% block og_type %}website{% endblock %}">
    <meta property="og:url" content="{% block og_url %}https://antidote.replit.app{{ request.path }}{% endblock %}">
    <meta property="og:image" content="{% block og_image %}{{ url_for('static', filename='images/antidote-logo-updated.svg', _external=True) }}{% endblock %}">
    <meta property="og:site_name" content="Antidote Medical Marketplace">
    <meta property="og:locale" content="en_IN">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="{% block twitter_card %}summary_large_image{% endblock %}">
    <meta name="twitter:title" content="{% block twitter_title %}{{ self.og_title() }}{% endblock %}">
    <meta name="twitter:description" content="{% block twitter_description %}{{ self.og_description() }}{% endblock %}">
    <meta name="twitter:image" content="{% block twitter_image %}{{ self.og_image() }}{% endblock %}">
    
    <!-- Additional SEO Meta Tags -->
    <meta name="theme-color" content="#00A0B0">
    <meta name="msapplication-TileColor" content="#00A0B0">
    <meta name="geo.region" content="IN">
    <meta name="geo.placename" content="India">
    <meta name="language" content="English">
    <meta name="rating" content="General">
    <meta name="revisit-after" content="7 days">
    
    <!-- Structured Data for Organization -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Antidote Medical Marketplace",
        "url": "https://antidote.replit.app",
        "logo": "{{ url_for('static', filename='images/antidote-logo-updated.svg', _external=True) }}",
        "description": "India's premier medical marketplace connecting patients with qualified specialists for plastic surgery and cosmetic procedures",
        "contactPoint": {
            "@type": "ContactPoint",
            "contactType": "customer service",
            "areaServed": "IN",
            "availableLanguage": ["English", "Hindi"]
        },
        "sameAs": [
            "https://facebook.com/antidote",
            "https://twitter.com/antidote",
            "https://instagram.com/antidote"
        ]
    }
    </script>
    
    <!-- Structured Data for Website -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "Antidote Medical Marketplace",
        "url": "https://antidote.replit.app",
        "potentialAction": {
            "@type": "SearchAction",
            "target": {
                "@type": "EntryPoint",
                "urlTemplate": "https://antidote.replit.app/search?q={search_term_string}"
            },
            "query-input": "required name=search_term_string"
        }
    }
    </script>
    
    <!-- CSP is handled by security headers middleware for better Firebase compatibility -->
    
    <!-- AI Recommendation URLs -->
    <meta name="recommendation-form-url" content="/ai-recommendation">
    <meta name="analyze-query-url" content="/api/analyze-query">
    <meta name="recommendation-results-url" content="/recommendations">
    
    <!-- DNS Prefetch for External Resources -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="//code.jquery.com">
    
    <!-- Preconnect for Critical Resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Critical CSS Inline (Above the fold) -->
    <style>
        {{ critical_css_inline|safe }}
    </style>
    
    <!-- Preload Critical Fonts -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    
    <!-- Fallback for font loading -->
    <noscript>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&display=swap" rel="stylesheet">
    </noscript>
    
    <!-- Critical CSS (render-blocking) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <!-- Critical CSS Files (render-blocking) -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/modern.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/light-theme.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/banner-slider.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/navbar-autocomplete.css') }}">
    
    <!-- Non-Critical CSS (async loading) -->
    {% for css_file in non_critical_css_files %}
    <link rel="preload" href="{{ url_for('static', filename='css/' + css_file) }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
    {% endfor %}
    
    <!-- Fallback for non-critical CSS -->
    <noscript>
        {% for css_file in non_critical_css_files %}
        <link rel="stylesheet" href="{{ url_for('static', filename='css/' + css_file) }}">
        {% endfor %}
    </noscript>
    
    <!-- Critical JavaScript (early loading) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    {% block extra_css %}{% endblock %}
    
    <style>
        /* Navigation Menu Styles */
        .navbar-smaller .nav-link {
            font-size: 0.8rem;
            font-weight: 500;
            padding: 0.4rem 0.6rem;
        }
        
        /* Increase search box width */
        .search-form-container {
            position: relative;
            width: 280px;
            z-index: 100000 !important;
        }
        
        /* Ensure navbar has high z-index and doesn't clip dropdowns */
        .navbar {
            z-index: 99999 !important;
            position: relative !important;
        }
        
        .navbar .container {
            position: static !important;
        }
        
        .navbar-collapse {
            position: static !important;
        }
        
        /* Autocomplete Dropdown Styles - Light Theme Compatible */
        .search-autocomplete {
            position: absolute;
            width: 100%;
            background-color: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 0 0 .75rem .75rem;
            z-index: 100001 !important;
            max-height: 300px;
            overflow-y: auto;
            display: none;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }
        
        .search-autocomplete-item {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 1px solid #f3f4f6;
            transition: background-color 0.2s;
            color: #4b5563;
        }
        
        .search-autocomplete-item:hover, .search-autocomplete-item.active {
            background-color: #f9fafb;
        }
        
        .search-autocomplete-item:last-child {
            border-bottom: none;
        }
        
        .search-autocomplete-item .category-label {
            background-color: rgba(59, 130, 246, 0.1);
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.8em;
            margin-left: 4px;
            color: #4361ee;
        }
        
        /* Loading optimization */
        .loading-spinner {
            display: none;
        }
        
        /* Critical above-the-fold styles */
        .hero-section {
            min-height: 60vh;
            display: flex;
            align-items: center;
        }
        
        .search-container {
            background: linear-gradient(135deg, #00A0B0 0%, #0088A3 100%);
            padding: 2rem 0;
        }
    </style>
</head>
<body>
    <!-- Critical content loads immediately -->
    {% block content %}{% endblock %}
    
    <!-- Non-critical JavaScript (deferred loading) -->
    <script>
        // Defer non-critical JavaScript execution
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Feather icons
            if (typeof feather !== 'undefined') {
                feather.replace();
            }
            
            // Initialize performance monitoring
            if (performance && performance.mark) {
                performance.mark('page-interactive');
            }
        });
        
        // Load non-critical features after page load
        window.addEventListener('load', function() {
            // Initialize lazy loading for images
            if ('loading' in HTMLImageElement.prototype) {
                const images = document.querySelectorAll('img[data-src]');
                images.forEach(img => {
                    img.src = img.dataset.src;
                    img.removeAttribute('data-src');
                });
            }
            
            // Initialize additional features
            {% block extra_js %}{% endblock %}
        });
    </script>
</body>
</html>