console.log("Favorites.js loaded"),document.addEventListener("DOMContentLoaded",function(){console.log("DOM loaded");var e=document.querySelectorAll("form"),e=(console.log("Total forms on page:",e.length),e.forEach((e,o)=>{console.log(`Form ${o} classes:`,e.className)}),document.querySelectorAll("form.save-form")),e=(console.log("Found save forms:",e.length),e.forEach(s=>{let t=s.querySelector("button.save-btn"),n=s.querySelector('input[name="doctor_id"]'),r=(s.querySelector('input[name="procedure_id"]'),s.querySelector('input[name="csrf_token"]'));t?(console.log("Save button found in form for doctor_id:",n?n.value:"N/A"),t.addEventListener("click",function(e){e.preventDefault(),console.log("Save button clicked for doctor_id:",n?n.value:"N/A");var e=new FormData(s),o={"X-Requested-With":"XMLHttpRequest"};r?(console.log("CSRF token found:",r.value.substring(0,5)+"..."),o["X-CSRFToken"]=r.value):console.warn("No CSRF token found in the form"),fetch(s.action,{method:"POST",body:e,headers:o,credentials:"same-origin"}).then(e=>{var o;if(console.log("Response status:",e.status),e.ok)return(o=e.headers.get("content-type"))&&o.includes("application/json")?e.json():(console.log("Response is not JSON, returning success object"),{success:!0,message:"Item saved successfully"});throw new Error("HTTP error! status: "+e.status)}).then(e=>{var o;e.success?(console.log("Save successful:",e.message),o=(o=t.querySelector("i"))?`<i class="${o.className}"></i> `:'<i class="fas fa-heart"></i> ',t.innerHTML=o+"Saved",t.disabled=!0,t.classList.remove("btn-outline-danger"),t.classList.add("btn-danger")):console.error("Save failed:",e.message)}).catch(e=>{console.error("AJAX error:",e.message),t.innerHTML='<i class="fas fa-heart"></i> Saved',t.disabled=!0,t.classList.remove("btn-outline-danger"),t.classList.add("btn-danger")})})):console.error('No save button with class "save-btn" found in form')}),document.querySelectorAll("form.remove-form"));console.log("Found remove forms:",e.length),e.forEach(s=>{let e=s.querySelector('button[data-action="remove"]'),t=s.querySelector('input[name="csrf_token"]');e?(console.log("Remove button found in form"),e.addEventListener("click",function(e){e.preventDefault(),console.log("Remove button clicked");var e=new FormData(s),o={"X-Requested-With":"XMLHttpRequest"};t?(console.log("CSRF token found for remove:",t.value.substring(0,5)+"..."),o["X-CSRFToken"]=t.value):console.warn("No CSRF token found in the remove form"),fetch(s.action,{method:"POST",body:e,headers:o,credentials:"same-origin"}).then(e=>{var o;if(console.log("Response status:",e.status),e.ok)return(o=e.headers.get("content-type"))&&o.includes("application/json")?e.json():(console.log("Response is not JSON, returning success object"),{success:!0,message:"Item removed successfully"});throw new Error("HTTP error! status: "+e.status)}).then(e=>{var o;e.success?(console.log("Remove successful:",e.message),(o=s.closest(".favorite-item, .list-group-item, .card"))?o.remove():window.location.reload()):console.error("Remove failed:",e.message)}).catch(e=>{console.error("AJAX error:",e.message),window.location.reload()})})):console.error("No remove button found in form")})});